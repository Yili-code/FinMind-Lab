# FinMind Lab 專案階段規劃

本文檔將 FinMind Lab 專案分成數個可測試的階段，每個階段完成後都可以進行獨立測試，確保專案與預期一致。

---

## 階段總覽

| 階段 | 名稱 | 描述 | 預估時間 | 測試重點 | 進度 |
|------|------|------|----------|----------| ---- |
| **階段 0** | 環境設置與基礎驗證 | 確保開發環境正確配置 | 30分鐘 | 環境、依賴、基本連接 | 0 |
| **階段 1** | 後端基礎架構 | 後端 API 服務建立與基本端點 | 2-3小時 | API 端點、資料庫初始化 | 0 |
| **階段 2** | 前端基礎架構 | 前端路由、導航、基本頁面 | 2-3小時 | 路由、導航、頁面渲染 | 0 | 
| **階段 3** | 後端數據服務 | yfinance 整合與股票數據獲取 | 3-4小時 | 數據獲取、API 響應 | 0 |
| **階段 4** | 功能一：數據整合 | 股票成交明細、日交易檔、圖表 | 4-5小時 | 數據顯示、圖表、表格 | 0 |
| **階段 5** | 功能二：股票基本檔管理 | 本地儲存管理功能 | 2-3小時 | CRUD 操作、本地儲存 | 0 |
| **階段 6** | 財務報表功能 | 三大財務報表查詢與顯示 | 3-4小時 | 財務數據、表格顯示 | 0 |
| **階段 7** | 資料庫整合 | 將 localStorage 遷移至 SQLite | 4-5小時 | 資料庫操作、數據持久化 | 0 |
| **階段 8** | UI/UX 優化 | 樣式優化、響應式設計、錯誤處理 | 3-4小時 | 視覺效果、使用者體驗 | 0 |
| **階段 9** | 整合測試與優化 | 端到端測試、性能優化 | 2-3小時 | 整體功能、性能 | 0 |

---

## 階段 0：環境設置與基礎驗證

### 目標
確保開發環境正確配置，所有依賴套件正確安裝，前後端可以正常啟動。

### 任務清單
- [ ] 確認 Python 3.10+ 已安裝
- [ ] 確認 Node.js 18+ 已安裝
- [ ] 建立 Python 虛擬環境
- [ ] 安裝後端依賴套件
- [ ] 安裝前端依賴套件
- [ ] 驗證後端可以啟動（`http://localhost:8000`）
- [ ] 驗證前端可以啟動（`http://localhost:5173`）
- [ ] 測試前後端基本連接（`GET /api/hello`）

### 測試檢查點
1. - 後端伺服器成功啟動，無錯誤訊息
2. - 前端開發伺服器成功啟動，無錯誤訊息
3. - 前端可以成功呼叫後端 API（`/api/hello`）
4. - 瀏覽器控制台無嚴重錯誤
5. - 後端 API 文檔可訪問（`http://localhost:8000/docs`）

### 完成標準
- 前後端都能正常啟動
- 基本 API 連接測試通過
- 無依賴套件錯誤

---

## 階段 1：後端基礎架構

### 目標
建立後端 API 服務的基礎架構，包括路由、CORS、錯誤處理、資料庫初始化。

### 任務清單
- [ ] 確認 `main.py` 中的 FastAPI 應用程式設定正確
- [ ] 確認 CORS 中介層配置正確
- [ ] 確認基本路由端點（`/`, `/api/hello`）正常運作
- [ ] 確認 `database.py` 可以初始化資料庫
- [ ] 確認資料庫表格創建成功（`stock_basics`, `income_statements`, `balance_sheets`, `cash_flows`）
- [ ] 確認 `models.py` 中的 Pydantic 模型定義正確
- [ ] 確認錯誤處理機制正常運作

### 測試檢查點
1. - `GET /` 返回 `{"message": "Hello from FastAPI"}`
2. - `GET /api/hello` 返回正確響應
3. - 資料庫檔案 `finmind_lab.db` 成功創建
4. - 所有資料庫表格成功創建（可用 SQLite 工具檢查）
5. - API 文檔（Swagger UI）可以正常訪問
6. - CORS 設定允許前端域名存取

### 完成標準
- 所有基本 API 端點正常運作
- 資料庫初始化成功
- API 文檔可正常訪問

---

## 階段 2：前端基礎架構

### 目標
建立前端應用的基礎架構，包括路由、導航、基本頁面結構。

### 任務清單
- [ ] 確認 React Router 配置正確
- [ ] 確認所有路由路徑正確定義
- [ ] 確認 `Navbar` 組件正常顯示
- [ ] 確認 `Footer` 組件正常顯示
- [ ] 確認 `EntryPage` 可以正常訪問
- [ ] 確認所有頁面路由可以正常導航
- [ ] 確認路由懶加載正常運作
- [ ] 確認 `StockContext` 可以正常提供狀態

### 測試檢查點
1. - 訪問 `http://localhost:5173/` 顯示入口頁面
2. - 導航列正常顯示，所有連結可點擊
3. - 頁尾正常顯示
4. - 所有路由頁面可以正常訪問：
   - `/` (EntryPage)
   - `/function1` (Function1Page)
   - `/function2` (Function2Page)
   - `/financial-reports` (FinancialReportsPage)
   - `/contact` (ContactPage)
   - `/privacy` (PrivacyPage)
   - `/terms` (TermsPage)
5. - 路由切換時無錯誤訊息
6. - 瀏覽器控制台無路由相關錯誤

### 完成標準
- 所有路由正常運作
- 導航功能正常
- 基本頁面結構完整

---

## 階段 3：後端數據服務

### 目標
整合 yfinance 服務，實現股票數據獲取功能，確保所有 API 端點可以正常返回數據。

### 任務清單
- [ ] 確認 `services/yfinance_service.py` 中的函數正常運作
- [ ] 測試 `GET /api/stock/info/{stock_code}` 端點
- [ ] 測試 `GET /api/stock/intraday/{stock_code}` 端點
- [ ] 測試 `GET /api/stock/daily/{stock_code}` 端點
- [ ] 測試 `GET /api/stock/market-index` 端點
- [ ] 測試 `GET /api/stock/financial/{stock_code}` 端點
- [ ] 測試 `GET /api/stock/batch` 端點
- [ ] 確認錯誤處理（無效股票代號、網路錯誤等）
- [ ] 確認數據格式符合前端型別定義

### 測試檢查點
1. - `GET /api/stock/info/2330` 返回台積電基本資訊
2. - `GET /api/stock/intraday/2330` 返回盤中數據
3. - `GET /api/stock/daily/2330?days=7` 返回日交易數據
4. - `GET /api/stock/market-index?index_code=^TWII&days=7` 返回大盤指數
5. - `GET /api/stock/financial/2330` 返回財務報表數據
6. - `GET /api/stock/batch?stock_codes=2330,2317` 返回批量股票資訊
7. - 無效股票代號返回適當錯誤訊息
8. - 所有響應數據格式符合 Pydantic 模型

### 測試腳本
可以使用 `backend/test_api.py` 進行自動化測試。

### 完成標準
- 所有股票數據 API 端點正常運作
- 數據格式正確
- 錯誤處理完善

---

## 階段 4：功能一：數據整合

### 目標
實現 Function1Page 的所有功能，包括股票成交明細、日交易檔查詢與顯示、圖表視覺化。

### 任務清單
- [ ] 確認 `Function1Page` 組件正常渲染
- [ ] 確認股票代號輸入功能正常
- [ ] 確認 `StockChart` 組件可以顯示圖表
- [ ] 確認 `TradeDetailTable` 可以顯示成交明細
- [ ] 確認 `DailyTradeTable` 可以顯示日交易檔
- [ ] 確認表格篩選功能正常
- [ ] 確認表格與圖表連動功能正常
- [ ] 確認大盤指數顯示正常
- [ ] 確認載入狀態顯示正常
- [ ] 確認錯誤訊息顯示正常

### 測試檢查點
1. - 輸入股票代號（如 2330）可以成功查詢
2. - 股票走勢圖正常顯示（K 線圖或折線圖）
3. - 成交明細表格正常顯示，包含時間、價格、成交量等欄位
4. - 日交易檔表格正常顯示，包含日期、開高低收、成交量等
5. - 表格篩選功能正常（時間範圍、價格範圍等）
6. - 點選表格資料時，圖表會相應更新
7. - 大盤指數正常顯示
8. - 載入中狀態正常顯示
9. - 錯誤情況（無效股票代號、網路錯誤）有適當提示

### 測試案例
- 測試股票代號：2330（台積電）、2317（鴻海）、2454（聯發科）
- 測試不同時間範圍（1天、7天、30天）
- 測試市場休市時的情況

### 完成標準
- 所有數據查詢功能正常
- 圖表正常顯示
- 表格功能完整
- 使用者體驗流暢

---

## 階段 5：功能二：股票基本檔管理

### 目標
實現 Function2Page 的股票基本檔管理功能，包括新增、編輯、刪除、本地儲存。

### 任務清單
- [ ] 確認 `Function2Page` 組件正常渲染
- [ ] 確認 `StockBasicForm` 表單正常運作
- [ ] 確認 `StockBasicTable` 表格正常顯示
- [ ] 確認新增股票功能正常
- [ ] 確認編輯股票功能正常
- [ ] 確認刪除股票功能正常
- [ ] 確認本地儲存（localStorage）正常運作
- [ ] 確認表格篩選功能正常
- [ ] 確認表單驗證正常
- [ ] 確認資料初始化正常（`initData.ts`）

### 測試檢查點
1. - 表格可以顯示已儲存的股票基本檔
2. - 新增股票功能正常，資料成功儲存到 localStorage
3. - 編輯股票功能正常，資料成功更新
4. - 刪除股票功能正常，資料成功移除
5. - 重新整理頁面後，資料仍然存在（localStorage 持久化）
6. - 表格篩選功能正常（依股票代號、名稱、產業等）
7. - 表單驗證正常（必填欄位、格式驗證等）
8. - 初始化資料正常載入

### 測試案例
- 新增多筆股票資料
- 編輯現有股票資料
- 刪除股票資料
- 測試表單驗證（空值、格式錯誤等）
- 清除瀏覽器資料後重新載入

### 完成標準
- 所有 CRUD 操作正常
- 本地儲存功能正常
- 表單驗證完善

---

## 階段 6：財務報表功能

### 目標
實現 FinancialReportsPage 的財務報表查詢與顯示功能，包括損益表、資產負債表、現金流量表。

### 任務清單
- [ ] 確認 `FinancialReportsPage` 組件正常渲染
- [ ] 確認股票代號輸入功能正常
- [ ] 確認 `IncomeStatementTable` 可以顯示損益表
- [ ] 確認 `BalanceSheetTable` 可以顯示資產負債表
- [ ] 確認 `CashFlowTable` 可以顯示現金流量表
- [ ] 確認財務資料儲存功能正常（localStorage）
- [ ] 確認多股票群組管理功能正常
- [ ] 確認財務摘要顯示正常
- [ ] 確認表格篩選功能正常

### 測試檢查點
1. - 輸入股票代號可以成功查詢財務報表
2. - 損益表正常顯示，包含營業收入、營業毛利、稅後淨利等
3. - 資產負債表正常顯示，包含總資產、股東權益、流動資產等
4. - 現金流量表正常顯示，包含營業現金流、投資現金流、融資現金流等
5. - 財務資料成功儲存到 localStorage
6. - 可以管理多個股票的財務資料群組
7. - 財務摘要正常顯示（關鍵指標）
8. - 表格篩選功能正常（依期間、項目等）

### 測試案例
- 測試股票代號：2330、2317、2454
- 測試多個股票的財務資料管理
- 測試不同期間的財務資料
- 測試資料持久化（重新整理頁面）

### 完成標準
- 所有財務報表正常顯示
- 資料儲存功能正常
- 多股票管理功能完整

---

## 階段 7：資料庫整合

### 目標
將前端使用 localStorage 的功能遷移至後端 SQLite 資料庫，實現真正的資料持久化。

### 任務清單
- [ ] 確認後端 `crud.py` 中的 CRUD 操作正常
- [ ] 實現股票基本檔的後端 API 端點
- [ ] 實現財務報表的後端 API 端點
- [ ] 修改前端 `Function2Page` 使用後端 API
- [ ] 修改前端 `FinancialReportsPage` 使用後端 API
- [ ] 確認資料遷移功能（從 localStorage 遷移至資料庫）
- [ ] 確認資料同步正常
- [ ] 確認錯誤處理完善

### 測試檢查點
1. - 後端 API 端點正常運作：
   - `POST /api/stock/basic` (新增)
   - `GET /api/stock/basic` (查詢)
   - `PUT /api/stock/basic/{id}` (更新)
   - `DELETE /api/stock/basic/{id}` (刪除)
2. - 前端 Function2Page 可以透過 API 操作資料庫
3. - 前端 FinancialReportsPage 可以透過 API 操作資料庫
4. - 資料成功儲存到 SQLite 資料庫
5. - 資料可以正常查詢、更新、刪除
6. - 資料遷移功能正常（如有需要）
7. - 錯誤處理完善（網路錯誤、資料庫錯誤等）

### 測試案例
- 測試所有 CRUD 操作
- 測試資料持久化（重啟伺服器後資料仍然存在）
- 測試並發操作
- 測試錯誤情況

### 完成標準
- 資料庫整合完成
- 所有功能正常運作
- 資料持久化正常

---

## 階段 8：UI/UX 優化

### 目標
優化使用者介面與使用者體驗，包括樣式優化、響應式設計、錯誤處理、載入狀態。

### 任務清單
- [ ] 確認設計系統 CSS 變數正常運作
- [ ] 確認所有頁面樣式一致
- [ ] 確認響應式設計正常（手機、平板、桌面）
- [ ] 確認載入狀態顯示正常
- [ ] 確認錯誤訊息顯示友善
- [ ] 確認表單驗證提示清楚
- [ ] 確認表格樣式美觀
- [ ] 確認圖表樣式美觀
- [ ] 確認動畫效果流暢
- [ ] 確認無障礙功能（可選）

### 測試檢查點
1. - 所有頁面樣式一致，符合設計系統
2. - 響應式設計正常：
   - 桌面版（> 1024px）正常顯示
   - 平板版（768px - 1024px）正常顯示
   - 手機版（< 768px）正常顯示
3. - 載入狀態正常顯示（骨架屏、載入動畫等）
4. - 錯誤訊息清楚易懂
5. - 表單驗證提示即時且清楚
6. - 表格樣式美觀，易於閱讀
7. - 圖表樣式美觀，資訊清楚
8. - 動畫效果流暢，不影響效能
9. - 瀏覽器相容性正常（Chrome、Firefox、Safari、Edge）

### 測試案例
- 測試不同螢幕尺寸
- 測試不同瀏覽器
- 測試載入狀態
- 測試錯誤情況
- 測試表單驗證

### 完成標準
- UI 美觀一致
- 響應式設計完善
- 使用者體驗流暢

---

## 階段 9：整合測試與優化

### 目標
進行端到端測試，優化性能，確保整體功能正常運作。

### 任務清單
- [ ] 進行端到端功能測試
- [ ] 測試所有頁面之間的導航
- [ ] 測試所有功能模組的整合
- [ ] 測試性能（載入時間、響應時間）
- [ ] 優化程式碼（移除未使用的程式碼、優化渲染）
- [ ] 確認無記憶體洩漏
- [ ] 確認無控制台錯誤
- [ ] 確認無 TypeScript 錯誤
- [ ] 確認無 ESLint 錯誤
- [ ] 撰寫測試報告

### 測試檢查點
1. - 所有功能模組正常運作
2. - 頁面導航流暢
3. - 資料流程正常（前端 ↔ 後端 ↔ 資料庫）
4. - 性能指標正常：
   - 頁面載入時間 < 3 秒
   - API 響應時間 < 2 秒
   - 圖表渲染時間 < 1 秒
5. - 無記憶體洩漏（長時間使用後仍正常）
6. - 無控制台錯誤
7. - 無 TypeScript 編譯錯誤
8. - 無 ESLint 錯誤
9. - 程式碼品質良好

### 測試案例
- 完整的使用者流程測試
- 壓力測試（大量資料）
- 長時間運行測試
- 跨瀏覽器測試
- 跨裝置測試

### 完成標準
- 所有功能正常運作
- 性能良好
- 程式碼品質良好
- 無重大錯誤

---

## 測試記錄範本

每個階段完成後，請記錄以下資訊：

```markdown
## 階段 X：XXX

### 完成日期
YYYY-MM-DD

### 測試結果
- [ ] 所有測試檢查點通過
- [ ] 發現的問題：
  1. 問題描述
  2. 問題描述
- [ ] 已修復的問題
- [ ] 待處理的問題

### 備註
（任何需要記錄的資訊）
```

---

## 快速開始

1. **從階段 0 開始**：確保環境設置正確
2. **依序完成各階段**：每個階段完成後進行測試
3. **記錄測試結果**：使用測試記錄範本
4. **解決問題**：遇到問題時，先解決再進入下一階段

---

## 支援

如有任何問題，請參考：
- 前端文檔：`frontend/README.md`
- 後端文檔：`backend/README.md`
- 測試文檔：`backend/TESTING.md`

---

**最後更新**：2024-12-19

